<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat28</title>
    <link rel="stylesheet" href="stylesheets/chat-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">

</head>

<body data-theme="light">
    <div class="drop-zone" id="dropZone">
        <i class="fa-solid fa-folder-open"></i>Drop files here to upload
    </div>

    <div class="navbar-top">
        <div class="page-title">Chat28</div>
        <div class="top-controls">
            <button class="profile-btn" onclick="showProfile()"><i class="fa-solid fa-user"></i> Profile</button>
            <button class="mode-toggle" onclick="toggleMode()"><i class="fa-solid fa-moon"></i> Dark Mode</button>
        </div>
    </div>
    <!-- left nav bar container -->
    <div class="chat-container">
        <div class="navbar">
            <div class="logo"><i class="fa-solid fa-comment"></i> Chat28</div>

            <div class="user-count">
                <i class="fa-solid fa-users"></i> 5 Members Online
            </div>

            <div class="section-title">Online Members</div>
            <div class="tab-content">
                <div class="user-item">
                    <div class="user-info">
                        <div class="user-name">Alice Johnson</div>
                        <div class="user-status online">
                            <span class="status-indicator"></span>
                            Online
                        </div>
                    </div>
                    <button class="private-msg-btn" onclick="startPrivateChat('Alice Johnson')">
                        <i class="fa-solid fa-envelope"></i>
                        PM
                    </button>
                </div>
                <!-- User info in nav bar-->
                <div class="user-item">
                    <div class="user-info">
                        <div class="user-name">Bob Smith</div>
                        <div class="user-status online">
                            <span class="status-indicator"></span>
                            Online
                        </div>
                    </div>
                    <button class="private-msg-btn" onclick="startPrivateChat('Bob Smith')">
                        <i class="fa-solid fa-envelope"></i>
                        PM
                    </button>
                </div>

                <div class="user-item">
                    <div class="user-info">
                        <div class="user-name">Charlie Brown</div>
                        <div class="user-status away">
                            <span class="status-indicator"></span>
                            Away
                        </div>
                    </div>
                    <button class="private-msg-btn" onclick="startPrivateChat('Charlie Brown')">
                        <i class="fa-solid fa-envelope"></i>
                        PM
                    </button>
                </div>

                <div class="user-item">
                    <div class="user-info">
                        <div class="user-name">Diana Prince</div>
                        <div class="user-status online">
                            <span class="status-indicator"></span>
                            Online
                        </div>
                    </div>
                    <button class="private-msg-btn" onclick="startPrivateChat('Diana Prince')">
                        <i class="fa-solid fa-envelope"></i>
                        PM
                    </button>
                </div>

                <div class="user-item">
                    <div class="user-info">
                        <div class="user-name">Eve Wilson</div>
                        <div class="user-status online">
                            <span class="status-indicator"></span>
                            Online
                        </div>
                    </div>
                    <button class="private-msg-btn" onclick="startPrivateChat('Eve Wilson')">
                        <i class="fa-solid fa-envelope"></i>
                        PM
                    </button>
                </div>
            </div>

            <div class="section-title" style="margin-top: 20px;">Offline Members</div>
            <div class="tab-content">
                <div class="user-item">
                    <div class="user-info">
                        <div class="user-name">Frank Miller</div>
                        <div class="user-status offline">
                            <span class="status-indicator"></span>
                            Last seen 2h ago
                        </div>
                    </div>
                    <button class="private-msg-btn" onclick="startPrivateChat('Frank Miller')">
                        <i class="fa-solid fa-envelope"></i>
                        PM
                    </button>
                </div>

                <div class="user-item">
                    <div class="user-info">
                        <div class="user-name">Grace Lee</div>
                        <div class="user-status offline">
                            <span class="status-indicator"></span>
                            Last seen 1d ago
                        </div>
                    </div>
                    <button class="private-msg-btn" onclick="startPrivateChat('Grace Lee')">
                        <i class="fa-solid fa-envelope"></i>
                        PM
                    </button>
                </div>
            </div>
        </div>
        <!-- main chat layout -->
        <div class="main-chat">
            <div class="chat-header">
                <div>
                    <div class="chat-title">Public Channel</div>
                    <div class="chat-subtitle">7 total members ‚Ä¢ 5 online</div>
                </div>
                <div class="chat-actions">
                    <button class="action-btn" onclick="showChannelInfo()"><i class="fa-solid fa-circle-info"></i>
                        Info</button>
                </div>
            </div>
            <!-- Message container -->
            <div class="message-container" id="messageContainer">
                <div class="message">
                    <div class="message-header">
                        <span class="message-sender">Alice Johnson</span>
                        <span>Public</span>
                    </div>
                    <div class="text">Welcome everyone to our public channel!</div>
                    <div class="message-time">10:30 AM</div>
                </div>

                <div class="my message">
                    <div class="message-header">
                        <span class="message-sender">You</span>
                        <span>Public</span>
                    </div>
                    <div class="text">Hello everyone! Happy to be here.</div>
                    <div class="message-time">10:32 AM</div>
                </div>

                <div class="message private-message">
                    <div class="message-header">
                        <span class="message-sender">Bob Smith</span>
                        <span>Private to you</span>
                    </div>
                    <div class="text">Hey, can we discuss the project privately?</div>
                    <div class="message-time">10:35 AM</div>
                </div>

                <div class="message">
                    <div class="message-header">
                        <span class="message-sender">Diana Prince</span>
                        <span>Public</span>
                    </div>
                    <div class="text">Here's the document we discussed earlier.</div>
                    <div class="file" onclick="downloadFile('Requirements.pdf')">
                        <div class="file-icon"><i class="fa-solid fa-file-pdf"></i></div>
                        <div class="file-details">
                            <div class="file-name">Requirements.pdf</div>
                            <div class="file-size">1.2 MB</div>
                        </div>
                    </div>
                    <div class="message-time">10:37 AM</div>
                </div>

                <div class="my message">
                    <div class="message-header">
                        <span class="message-sender">You</span>
                        <span>Public</span>
                    </div>
                    <div class="text">Thanks Diana! That's exactly what we needed.</div>
                    <div class="message-time">10:38 AM</div>
                </div>
            </div>

            <div class="message-input-container">
                <div class="message-type-selector">
                    <button class="type-btn active" onclick="setMessageType('public', this)">
                        <i class="fa-solid fa-globe"></i> Public
                    </button>
                    <button class="type-btn" onclick="setMessageType('private', this)">
                        <i class="fa-solid fa-lock"></i> Private
                    </button>
                </div>
                <!-- Private message recipient selector -->
                <div class="private-recipient-selector" id="recipientSelector">
                    <div class="recipient-label">Send private message to:</div>
                    <select class="recipient-select" id="recipientSelect">
                        <option value="">Select recipient...</option>
                        <option value="Alice Johnson">Alice Johnson</option>
                        <option value="Bob Smith">Bob Smith</option>
                        <option value="Charlie Brown">Charlie Brown</option>
                        <option value="Diana Prince">Diana Prince</option>
                        <option value="Eve Wilson">Eve Wilson</option>
                        <option value="Frank Miller">Frank Miller</option>
                        <option value="Grace Lee">Grace Lee</option>
                    </select>
                </div>
                <!-- Message input area -->
                <div class="input-wrapper">
                    <textarea class="message-input" id="messageInput" placeholder="Type your message..." rows="1"
                        onkeydown="handleKeyPress(event)" oninput="adjustHeight(this)"></textarea>
                    <div class="input-actions">
                        <input type="file" class="file-input" id="fileInput" multiple
                            onchange="handleFileSelect(event)">
                        <button class="input-btn" onclick="triggerFileInput()" title="Attach file">
                            <i class="fa-solid fa-paperclip"></i>
                        </button>
                        <button class="input-btn" onclick="addEmoji()" title="Add emoji">
                            <i class="fa-solid fa-smile"></i>
                        </button>
                        <button class="input-btn send-btn" onclick="sendMessage()" title="Send message">
                            <i class="fa-solid fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentMessageType = 'public';
        let dragCounter = 0;

        // Initialize drag and drop
        document.addEventListener('DOMContentLoaded', function () {
            const dropZone = document.getElementById('dropZone');
            const chatContainer = document.querySelector('.chat-container');

            chatContainer.addEventListener('dragenter', handleDragEnter);
            chatContainer.addEventListener('dragleave', handleDragLeave);
            chatContainer.addEventListener('dragover', handleDragOver);
            chatContainer.addEventListener('drop', handleDrop);

            // Focus on message input
            document.getElementById('messageInput').focus();

            // Set initial scroll position
            const messageContainer = document.getElementById('messageContainer');
            messageContainer.scrollTop = messageContainer.scrollHeight;
        });

        // Dark mode toggle function
        function toggleMode() {
            const body = document.body;
            const modeBtn = document.querySelector('.mode-toggle');

            if (body.getAttribute('data-theme') === 'light') {
                body.setAttribute('data-theme', 'dark');
                modeBtn.innerHTML = '<i class="fa-solid fa-sun"></i> Light Mode';
            } else {
                body.setAttribute('data-theme', 'light');
                modeBtn.innerHTML = '<i class="fa-solid fa-moon"></i> Dark Mode';
            }
        }

        // Profile function
        function showProfile() {
            alert('Profile settings would open here!');
        }

        // Channel info function
        function showChannelInfo() {
            alert('Channel information would display here!');
        }

        // Set message type (public or private)
        function setMessageType(type, btn) {
            currentMessageType = type;

            // Update button states
            document.querySelectorAll('.type-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            // Show/hide recipient selector
            const recipientSelector = document.getElementById('recipientSelector');
            if (type === 'private') {
                recipientSelector.classList.add('active');
            } else {
                recipientSelector.classList.remove('active');
            }
        }

        // Start private chat with specific user
        function startPrivateChat(userName) {
            // Switch to private message mode
            const privateBtn = document.querySelector('.type-btn:nth-child(2)');
            setMessageType('private', privateBtn);

            // Set recipient
            const recipientSelect = document.getElementById('recipientSelect');
            recipientSelect.value = userName;

            // Focus on input
            document.getElementById('messageInput').focus();
        }

        // File upload functions
        function handleDragEnter(e) {
            e.preventDefault();
            dragCounter++;
            document.getElementById('dropZone').classList.add('active');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            dragCounter--;
            if (dragCounter === 0) {
                document.getElementById('dropZone').classList.remove('active');
            }
        }

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDrop(e) {
            e.preventDefault();
            dragCounter = 0;
            document.getElementById('dropZone').classList.remove('active');

            const files = Array.from(e.dataTransfer.files);
            if (files.length > 0) {
                handleFiles(files);
            }
        }

        function triggerFileInput() {
            document.getElementById('fileInput').click();
        }

        function handleFileSelect(event) {
            const files = Array.from(event.target.files);
            if (files.length > 0) {
                handleFiles(files);
            }
            event.target.value = '';
        }

        function handleFiles(files) {
            files.forEach(file => {
                displayFileMessage(file);
            });
        }

        function displayFileMessage(file) {
            const messagesContainer = document.getElementById('messageContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'my message';

            const fileIcon = getFileIcon(file.name);
            const fileSize = formatFileSize(file.size);
            const messageTypeLabel = currentMessageType === 'private' ? 'Private' : 'Public';

            messageDiv.innerHTML = `
                <div class="message-content">
                    <div class="message-header">
                        <span class="message-sender">You</span>
                        <span>${messageTypeLabel}</span>
                    </div>
                    <div class="text">Shared a file:</div>
                    <div class="file" onclick="downloadFile('${file.name}')">
                        <div class="file-icon">${fileIcon}</div>
                        <div class="file-details">
                            <div class="file-name">${file.name}</div>
                            <div class="file-size">${fileSize}</div>
                        </div>
                    </div>
                    <div class="message-time">${new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</div>
                </div>
            `;

            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function getFileIcon(fileName) {
            const extension = fileName.split('.').pop().toLowerCase();
            const iconMap = {
                'pdf': '<i class="fa-solid fa-file-pdf"></i>',
                'doc': '<i class="fa-solid fa-file-word"></i>',
                'docx': '<i class="fa-solid fa-file-word"></i>',
                'xls': '<i class="fa-solid fa-file-excel"></i>',
                'xlsx': '<i class="fa-solid fa-file-excel"></i>',
                'ppt': '<i class="fa-solid fa-file-powerpoint"></i>',
                'pptx': '<i class="fa-solid fa-file-powerpoint"></i>',
                'jpg': '<i class="fa-solid fa-file-image"></i>',
                'jpeg': '<i class="fa-solid fa-file-image"></i>',
                'png': '<i class="fa-solid fa-file-image"></i>',
                'gif': '<i class="fa-solid fa-file-image"></i>',
                'mp4': '<i class="fa-solid fa-file-video"></i>',
                'avi': '<i class="fa-solid fa-file-video"></i>',
                'mp3': '<i class="fa-solid fa-file-audio"></i>',
                'wav': '<i class="fa-solid fa-file-audio"></i>',
                'zip': '<i class="fa-solid fa-file-archive"></i>',
                'rar': '<i class="fa-solid fa-file-archive"></i>',
                'txt': '<i class="fa-solid fa-file-alt"></i>'
            };
            return iconMap[extension] || '<i class="fa-solid fa-file"></i>';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function downloadFile(fileName) {
            alert(`Downloading ${fileName}...`);
        }

        // Send message
        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const text = messageInput.value.trim();

            if (text === '') return;

            // Check if private message needs recipient
            if (currentMessageType === 'private') {
                const recipient = document.getElementById('recipientSelect').value;
                if (!recipient) {
                    alert('Please select a recipient for private message.');
                    return;
                }
            }

            const messagesContainer = document.getElementById('messageContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'my message';

            if (currentMessageType === 'private') {
                messageDiv.classList.add('private-message');
            }

            const messageTypeLabel = currentMessageType === 'private' ? 'Private' : 'Public';

            messageDiv.innerHTML = `
                <div class="message-content">
                    <div class="message-header">
                        <span class="message-sender">You</span>
                        <span>${messageTypeLabel}</span>
                    </div>
                    <div class="text">${text}</div>
                    <div class="message-time">${new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</div>
                </div>
            `;

            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            messageInput.value = '';
            adjustHeight(messageInput);

            // Simulate a response
            setTimeout(() => {
                simulateResponse(messagesContainer);
            }, 1000 + Math.random() * 2000);
        }

        // Simulate response message
        function simulateResponse(container) {
            const responses = [
                "That sounds great!",
                "Thanks for the update!",
                "I agree with that approach.",
                "Let me check on that and get back to you.",
                "Perfect timing!",
                "I'll take care of that right away.",
                "Good point, let's discuss this further.",
                "Understood, thanks for clarifying."
            ];

            const users = ['Alice Johnson', 'Bob Smith', 'Diana Prince', 'Eve Wilson'];
            const randomUser = users[Math.floor(Math.random() * users.length)];
            const responseText = responses[Math.floor(Math.random() * responses.length)];

            const responseDiv = document.createElement('div');
            responseDiv.className = 'message';
            responseDiv.innerHTML = `
                <div class="message-content">
                    <div class="message-header">
                        <span class="message-sender">${randomUser}</span>
                        <span>Public</span>
                    </div>
                    <div class="text">${responseText}</div>
                    <div class="message-time">${new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</div>
                </div>
            `;

            container.appendChild(responseDiv);
            container.scrollTop = container.scrollHeight;
        }

        // Handle enter key
        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        // Auto-resize textarea
        function adjustHeight(element) {
            element.style.height = 'auto';
            element.style.height = element.scrollHeight + 'px';
        }

        // Add emoji function
        function addEmoji() {
            const messageInput = document.getElementById('messageInput');
            const emojis = ['üòä', 'üòÑ', 'üòç', 'ü§î', 'üëç', 'üëé', '‚ù§Ô∏è', 'üî•', 'üíØ', 'üéâ'];
            const randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];

            messageInput.value += randomEmoji;
            messageInput.focus();
            adjustHeight(messageInput);
        }
    </script>
</body>

</html>